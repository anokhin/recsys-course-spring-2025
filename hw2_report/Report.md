# Abstract

Мы сделали лёгкий гибрид. Если человек почти дослушал трек, берём кандидаты из двух мест — все другие треки того же артиста и список «похожих». Каждому кандидату даём очки за принадлежность артисту, за похожесть и за то, что пользователь ещё не слышал этот трек. Потом нормируем очки до вероятностей и случайно выбираем один трек.

# Детали

У каждого пользователя в Redis хранится последние сто треков. Когда доля прослушивания прошлого трека ≥ 60 %, этот трек кладётся в историю. При генерации рекомендации мы читаем artists_redis и поле similar в объекте трека из tracks_redis. Убираем уже прослушанное. Балл считается по формуле 0.45 × «артист» + 0.35 × «похожесть» + 0.20 × «свежесть». Лёгкий шум добавляет разнообразие. Если кандидатов нет, отдаём трек из случайного fallback.

### Инструкция по запуску

```
cd /botify/
docker compose up -d --build --force-recreate --scale recommender=2
```

```
cd ../sim/
python -m sim.run --episodes 10000 --config config/env.yml multi --processes 8
```

```
cd ../script/
python3 dataclient.py --recommender 2 log2local ../data-rec/data
```

---

### Для A/B запускаем jupyter/Week1Seminar.ipynb

![ab_test.png](ab_test.png)